% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/09_plot_utils.R
\name{scatter_lm_marginal}
\alias{scatter_lm_marginal}
\title{带边缘密度/直方图与回归方程的散点图（增强版）}
\usage{
scatter_lm_marginal(
  data,
  x,
  y,
  digits = 3,
  label.x = NULL,
  label.y = NULL,
  color = NULL,
  marginal = c("histogram", "density", "boxplot"),
  bins = 15,
  margin_fill = "grey60",
  margin_color = "white",
  ...
)
}
\arguments{
\item{data}{数据框，必须包含 x、y 及可选 color 分组变量}

\item{x, y}{字符标量，变量名}

\item{digits}{方程/统计量小数位，默认 3（已由 stat_poly_eq 控制）}

\item{label.x, label.y}{弃用，保留参数位以便兼容旧接口}

\item{color}{字符标量，分组变量名；NULL 时无分组}

\item{marginal}{边缘图类型，固定为 "densigram"}

\item{bins}{直方图分箱数，透传给 ggExtra::ggMarginal}

\item{margin_fill, margin_color}{边缘图填充色/边框色}

\item{...}{额外美学参数，透传给 geom_point()}
}
\value{
\if{html}{\out{<div class="sourceCode">}}\preformatted{    ggplot 对象（含边缘图层），可继续 + 主题或保存
}\if{html}{\out{</div>}}
}
\description{
主图：散点 + 线性回归线 + 自动标注方程、R²、p 值（ggpmisc::stat_poly_eq）。
边缘：双侧 densigram（密度+直方图混合），支持分组着色。
颜色逻辑：无 color 时统一配色；有 color 时按分组变量自动着色并隐藏图例。
}
\details{
\itemize{
\item 使用 ggpmisc::stat_poly_line() + stat_poly_eq() 自动添加回归线及方程
\item 边缘图为 densigram（密度+直方图），支持分组颜色/填充
\item 无分组时统一 \verb{#479E88} 颜色；有分组时调用 scale_color_npg() 并隐藏图例
\item 返回对象已含边缘图层，可直接 ggsave()
}
}
\examples{
\dontrun{
p <- scatter_lm_marginal(mtcars, "wt", "mpg", color = "cyl", bins = 20)
print(p)
ggsave("scatter_marginal.png", p, width = 6, height = 5)
}

}
