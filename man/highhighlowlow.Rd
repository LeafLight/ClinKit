% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/06_interaction.R
\name{highhighlowlow}
\alias{highhighlowlow}
\title{High-High vs Low-Low 四分组逻辑回归 + 相加交互作用}
\usage{
highhighlowlow(
  data,
  A,
  B,
  outcome,
  model2 = NULL,
  model3 = NULL,
  model4 = NULL,
  file_res = "result.docx",
  file_int = NULL,
  recode = FALSE
)
}
\arguments{
\item{data}{\code{data.frame}，必须包含结局变量、A、B 及所有协变量}

\item{A}{字符标量，连续暴露 A 列名}

\item{B}{字符标量，连续暴露 B 列名}

\item{outcome}{字符标量，二分类结局变量名（0/1）}

\item{model2}{字符向量，Model2 新增协变量，默认 NULL}

\item{model3}{字符向量，Model3 额外协变量，默认 NULL}

\item{model4}{字符向量，Model4 额外协变量，默认 NULL}

\item{file_res}{输出 Word 文件名（含路径），默认 \code{"result.docx"}}

\item{file_int}{可选，交互作用单独报告文件名；若 NULL 则仅内部计算不单独输出}

\item{recode}{逻辑值，是否对交互作用变量重新编码，默认 FALSE}
}
\value{
\if{html}{\out{<div class="sourceCode">}}\preformatted{     四分组因子向量（invisible），方便后续二次分析
}\if{html}{\out{</div>}}
}
\description{
对两个连续暴露变量 A、B 同时按中位数二分类，生成 4 种暴露组合：
Low A/Low B（参照）、Low A/High B、High A/Low B、High A/High B，
依次拟合 4 层逻辑回归模型（单因素 + 3 个协变量梯度），
并计算各组 OR(95\%CI) 及相加交互作用（interactionR）。
结果汇总为发表级表格并写入 Word。
}
\details{
\enumerate{
\item 中位数自动计算，NA 会被忽略；二分类变量命名为 A_bin/B_bin
\item 4 种暴露组合按 Low/Low → High/High 顺序因子化，Low/Low 为参照
\item 使用 \code{glm(..., family = binomial())} 拟合，OR 及 95\%CI 通过 \code{broom::tidy(exponentiate = TRUE)} 提取
\item 相加交互作用由 \code{interactionR} 完成，输出 RERI、AP、SI 及其 95\%CI
\item Word 表含病例数、OR(95\%CI)、P 值，可直接用于论文
}
}
\examples{
\dontrun{
highhighlowlow(
  data   = OCdata,
  A      = "alc",
  B      = "smk",
  outcome = "oc",
  model2 = c("age", "sex"),
  model3 = "bmi",
  model4 = "edu",
  file_res = "joint.docx",
  file_int = "interactionR.docx"
)
}

}
